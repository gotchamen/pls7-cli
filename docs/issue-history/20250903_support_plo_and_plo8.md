## 질문 1

combinations.go 의 L12-14 를 보면 len(pool) < n 일 때 비정상 조건으로 판단해서 nil 을 리턴하는데, nil 대신 empty slice 인 [][]Card{{}} 을 리턴하면 NPE 에러를 막을 수 있지 않아? 굳이 nil 을 리턴하는 의도가 있어?

```go
if len(pool) < n {
    return nil
}
```

## 답변 1

좋은 질문입니다. NPE(Nil Pointer Exception)에 대한 우려는 매우 중요하며, 코드의 안정성을 위해 항상 고려해야 할 부분입니다.

len(pool) < n일 때 nil을 반환하는 것은 의도된 동작이며, 그 이유는 다음과 같습니다.

1. 의미의 명확성: combinations 함수의 반환 값은 '찾아낸 모든 조합의 목록'입니다.
    * len(pool) < n인 경우, n개의 카드를 뽑는 조합은 물리적으로 불가능합니다. 즉, 가능한 조합의 개수는 0개입니다.
    * Go에서 '결과 없음' 또는 '비어 있는 슬라이스'를 나타내는 가장 일반적이고 관용적인 방법은 nil 슬라이스입니다. len(nil)은 0이므로, for...range 구문으로 반복해도 아무 문제 없이 안전하게 동작합니다.
    * 반면, 제안해주신 [][]Card{{}}는 "비어 있는 조합 1개"를 의미합니다. 이는 n=0일 때(0개의 카드를 뽑는 조합은 '아무것도 뽑지 않는' 1가지 경우가 존재) 반환되는 값으로, len(pool) < n의 경우와는 의미가 다릅니다.

2. Go의 관용적 표현(Idiomatic Go): Go에서는 결과가 없는 슬라이스를 반환할 때 nil을 사용하는 것이 매우 일반적입니다. 이는 불필요한 메모리 할당을 피하는 효과도 있습니다. 표준 라이브러리를 포함한 많은 Go 코드에서 이러한 패턴을 발견할 수 있습니다.

결론적으로, nil을 반환하는 것은 '가능한 조합이 없으므로 빈 목록을 반환한다'는 명확한 의미를 가지며, Go의 관용적인 표현에 부합합니다. for...range 루프 등 일반적인 사용 사례에서 NPE를 유발하지 않으므로 안전하게 사용할 수 있습니다.

---

## 질문 2

combination_test.go 에 추가된 init 함수의 영향범위는 동일한 파일 내에 있는 함수들까지야, 아니면 poker 패키지 전체에 영향을 미쳐? init 함수의 동작원리를 자세히 설명해줘.

```go
func init() {
    logrus.SetLevel(logrus.DebugLevel)
}
```

## 답변 2

좋은 질문입니다. init 함수의 동작 원리와 영향 범위를 이해하는 것은 Go 언어에서 매우 중요합니다.

결론부터 말씀드리면, combinations_test.go에 추가된 init 함수는 `poker` 패키지 전체에 영향을 미칩니다.

init 함수의 동작 원리를 자세히 설명해 드리겠습니다.

### init 함수란?

init 함수는 Go 프로그램의 패키지가 초기화될 때 시스템에 의해 자동으로 실행되는 특별한 함수입니다. 인자나 반환값이 없으며, 코드에서 직접 호출할 수 없습니다.

```go
func init() {
    // 패키지 초기화 코드
}
```

### init 함수의 실행 시점과 순서

1. 패키지 Import: 프로그램에서 특정 패키지를 import하면, Go 런타임은 해당 패키지의 init 함수를 실행합니다.
2. 의존성 우선: 만약 A 패키지가 B 패키지를 import한다면, B 패키지의 init 함수가 A 패키지의 init 함수보다 반드시 먼저 실행됩니다.
3. 동일 패키지 내 실행 순서:
    * 하나의 패키지 안에 여러 개의 init 함수가 존재할 수 있습니다 (여러 파일에 나뉘어 있거나, 한 파일에 여러 개 있을 수도 있습니다).
    * Go 컴파일러는 해당 패키지에 속한 모든 .go 파일들을 파일 이름의 알파벳 순서대로 처리합니다.
    * 컴파일러는 각 파일 내에서 init 함수가 나타나는 순서대로 실행 계획을 세웁니다.
    * 결론적으로, 동일 패키지 내의 init 함수들은 파일 이름 순 -> 파일 내 코드 순서에 따라 순차적으로 실행됩니다.

### go test 와 init 함수

go test ./pkg/poker 명령을 실행하면, Go 컴파일러는 pkg/poker 디렉토리 안에 있는 모든 .go 파일과 _test.go 파일들을 묶어 하나의 임시 테스트용 패키지를 만듭니다.

제가 추가한 combinations_test.go 파일은 package poker로 선언되어 있으므로, 이 파일은 테스트 실행 시 poker 패키지의 일부가 됩니다.

따라서, 테스트가 시작되기 전에 Go 런타임은 poker 패키지를 초기화하면서 combinations_test.go 파일 안에 있는 init 함수를 실행합니다.

### 결론: init 함수의 영향 범위

init 함수 내에서 실행한 logrus.SetLevel(logrus.DebugLevel) 코드는 logrus 라이브러리의 전역(Global) 로그 레벨을 변경하는 것입니다.

따라서 init 함수가 실행된 이후부터는, 해당 테스트 프로그램이 끝날 때까지 poker 패키지 내의 다른 어떤 파일(evaluation.go, deck.go 등)에서 logrus를 사용하더라도 모두 Debug 레벨이 적용됩니다. 즉, 영향 범위는 파일 하나에 국한되지 않고 패키지 전체입니다.

---
